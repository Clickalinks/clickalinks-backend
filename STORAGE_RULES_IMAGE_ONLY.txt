# Firebase Storage Security Rules - Image Files Only
# Copy these rules to Firebase Console > Storage > Rules
# 
# SECURITY: These rules restrict uploads to image files only (JPEG, PNG, GIF, WebP)
# This provides the final security barrier at the storage level

rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Logo uploads directory - IMAGE FILES ONLY
    match /logos/{logoId} {
      // Allow public read access (needed for displaying logos on website)
      allow read: if true;
      
      // SECURITY: Only allow image files with size restriction
      // Validates both MIME type (contentType) and file size
      allow write: if request.resource.size < 5 * 1024 * 1024 // 5MB max
                   && request.resource.contentType.matches('image/(jpeg|jpg|png|gif|webp)');
      
      // Allow delete for cleanup (admin can delete via Firebase Console or backend)
      allow delete: if true;
    }
    
    // Deny all other paths by default
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}

# IMPORTANT: 
# 1. Go to Firebase Console: https://console.firebase.google.com/
# 2. Select your project: clickalinks-frontend
# 3. Go to Storage > Rules tab
# 4. Replace the existing rules with the rules above
# 5. Click "Publish"
#
# What these rules do:
# - ✅ Allows public read access (required for displaying logos)
# - ✅ Restricts uploads to image files only (JPEG, PNG, GIF, WebP)
# - ✅ Enforces 5MB file size limit
# - ✅ Blocks all other file types at the storage level
# - ✅ Provides final security barrier (defense in depth)

